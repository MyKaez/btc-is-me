<ion-header [translucent]="true">
  <ion-toolbar *ngIf="currentSession$ | async as session">
    <ion-title slot="start">Session</ion-title>
    <ion-toolbar slot="primary">
      <app-host slot="start" [session]="session" *ngIf="isSessionHost(session)"></app-host>
      <ion-button fill="clear" slot="end" (click)="logOut()" *ngIf="isSessionHost(session)">
        <ion-icon name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-toolbar>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Session</ion-title>
    </ion-toolbar>
  </ion-header>

  <div id="container">

    <div *ngIf="currentSession$ | async as session;else noSession">

      <ion-segment value="session-info" [(ngModel)]="type">
        <ion-segment-button value="session-info">
          <ion-label>Session</ion-label>
        </ion-segment-button>
        <ion-segment-button value="user-action" *ngIf="!isSessionHost(session)">
          <ion-label>User</ion-label>
        </ion-segment-button>
        <ion-segment-button value="message-center" *ngIf="user || isSessionHost(session)">
          <ion-label>Message Center</ion-label>
        </ion-segment-button>
      </ion-segment>

      <div [ngSwitch]="type" *ngIf="hubConnection$ | async as hubConnection">
        <div *ngSwitchCase="'session-info'">
          <app-session-info [session]="session"></app-session-info>
          <app-user-info [session]="session"></app-user-info>
        </div>
        <div *ngSwitchCase="'user-action'">
          <app-user [session]="session" [user]="user" [hubConnection]="hubConnection" (userChange)="setUser($event)"
            #userView></app-user>
        </div>
        <div *ngSwitchCase="'message-center'">
          <app-message-center [session]="session" [user]="user" [messages]="messages"></app-message-center>
        </div>
      </div>
    </div>

    <ng-template #noSession>
      <div *ngIf="loading$ | async;else enterData">
        Loading...
      </div>
      <ng-template #enterData>
        Please create a session or hook up into an existing one<br />
        <app-input-session (nameChange)="registerSession($event)"></app-input-session>
        <app-session-list></app-session-list>
      </ng-template>

    </ng-template>
  </div>
</ion-content>