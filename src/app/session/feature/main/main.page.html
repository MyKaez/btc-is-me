<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Session</ion-title>
    <ion-buttons slot="end" end>
      <ion-button ion-button color="royal" (click)="logOut()">log out</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Session</ion-title>
    </ion-toolbar>
  </ion-header>

  <div id="container">

    <div *ngIf="currentSession$ | async as session;else noSession">

      <ion-segment value="session-info" [(ngModel)]="type">
        <ion-segment-button value="session-info">
          <ion-label>Session</ion-label>
        </ion-segment-button>
        <ion-segment-button value="user-action">
          <ion-label>User</ion-label>
        </ion-segment-button>
        <ion-segment-button value="message-center">
          <ion-label>Message Center</ion-label>
        </ion-segment-button>
      </ion-segment>

      <div [ngSwitch]="type" *ngIf="hubConnection$ | async">
        <div *ngSwitchCase="'session-info'">
          <app-session-info [session]="session"></app-session-info>
        </div>
        <div *ngSwitchCase="'user-action'">
          <div *ngIf="isSessionHost(session);else userInfo">
            <app-host [session]="session"></app-host>
          </div>
          <ng-template #userInfo>
            <app-user [session]="session" [user]="user" (userChange)="setUser($event)"></app-user>
          </ng-template>
        </div>
        <div *ngSwitchCase="'message-center'">
          <app-message-center [session]="session" [user]="user" [messages]="messages"></app-message-center>
        </div>
      </div>
    </div>

    <ng-template #noSession>
      <div *ngIf="loading$ | async;else enterData">
        Loading...
      </div>
      <ng-template #enterData>
        Please create a session or hook up into an existing one<br />
        <app-input-session (nameChange)="registerSession($event)"></app-input-session>
      </ng-template>

    </ng-template>
  </div>
</ion-content>